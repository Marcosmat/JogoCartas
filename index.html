<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Or√°culo M√°gico</title>
<style>
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
    body {
        background: linear-gradient(135deg, #6e45ff, #3f87a6);
        display: flex; flex-direction: column;
        justify-content: center; align-items: center;
        min-height: 100vh; text-align: center; padding: 20px;
    }

    /* Carta */
    #card-pile {
        background-color: #ffffff;
        width: 250px; height: 350px;
        border-radius: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease;
        /* Inicialmente 'none', ser√° definido como 'flex' ap√≥s o dado */
        display: none; 
        justify-content: center; align-items: center;
        border: 5px solid #fff;
    }
    #card-pile .emoji { font-size: 150px; text-shadow: 0 0 10px rgba(0,0,0,0.1); }
    #card-pile:hover { transform: scale(1.05); box-shadow: 0 15px 30px rgba(0,0,0,0.4); }

    /* Bot√µes */
    .btn {
        margin-top: 20px;
        background-color: #ffd700;
        color: #000;
        font-weight: bold;
        padding: 12px 25px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-size: 1rem;
        box-shadow: 0 5px 10px rgba(0,0,0,0.25);
        transition: transform 0.2s, background-color 0.2s;
    }
    .btn:hover { transform: scale(1.05); background-color: #ffcc00; }

    /* Modal */
    .modal {
        display: none; position: fixed; z-index: 100; left: 0; top: 0;
        width: 100%; height: 100%; background-color: rgba(0,0,0,0.6);
        justify-content: center; align-items: center;
    }
    .modal-content {
        background-color: #fefefe; border-radius: 15px; padding: 30px;
        width: 90%; max-width: 500px; text-align: center; position: relative;
        animation: zoomIn 0.3s ease;
    }
    @keyframes zoomIn {
        from { transform: scale(0.5); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
    }
    .close-button {
        position: absolute; top: 10px; right: 20px;
        font-size: 30px; font-weight: bold; color: #aaa; cursor: pointer;
    }
    .close-button:hover { color: #000; }

    /* Desafio */
    #desafio-cat { font-size: 0.9rem; font-weight: bold; color: #555; margin-bottom: 10px; text-transform: uppercase; }
    #desafio-q { font-size: 1.5rem; margin-bottom: 25px; line-height: 1.4; }
    #show-answer-btn, #ok-btn {
        background-color: #28a745; color: white;
        padding: 12px 20px; border: none; border-radius: 8px;
        cursor: pointer; font-size: 1rem; margin: 5px;
    }
    #desafio-r { display: none; font-size: 1.3rem; font-weight: bold; color: #007bff; }

    /* Dado */
    #dice { font-size: 100px; margin: 20px 0; animation: spin 0.2s linear infinite; }
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

    /* Bot√µes dentro do modal do dado */
    .dice-buttons { margin-top: 20px; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
</style>
</head>
<body>

    <button id="dice-btn" class="btn">üé≤ Rolar Dado</button>

    <div id="card-pile" title="Clique para um novo desafio!">
        <span class="emoji">‚ùì</span>
    </div>

    <div id="challenge-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="close-btn">&times;</span>
            <h3 id="desafio-cat">Categoria</h3>
            <p id="desafio-q">Clique na carta!</p>
            <button id="show-answer-btn">Ver Resposta</button>
            <button id="ok-btn" style="display:none;">OK</button>
            <p id="desafio-r">A resposta aparece aqui.</p>
        </div>
    </div>

    <div id="dice-modal" class="modal">
        <div class="modal-content">
            <h2 id="dice-title">üé≤ Rolando o Dado...</h2>
            <div id="dice">‚öÄ</div>
            <div class="dice-buttons">
                <button id="ver-carta-btn" class="btn" style="display:none;">üÉè Escolher Carta</button>
                <button id="rolar-novamente-btn" class="btn" style="display:none;">üé≤ Rolar Novamente</button>
            </div>
        </div>
    </div>

<script>
const desafios = [
    { cat: "PADR√ïES", q: "Qual o pr√≥ximo passo? CIMA, DIREITA, BAIXO, CIMA, __?", r: "DIREITA" },
    { cat: "O INTRUSO", q: "Qual √© o diferente? MA√á√É, BANANA, CENOURA, UVA", r: "CENOURA (N√£o √© fruta)" },
    { cat: "L√ìGICA", q: "Se Patinho √© Pato, Gatinho √© __?", r: "Gato" },
    { cat: "DECOMPOSI√á√ÉO", q: "A palavra 'BOLA' tem quantas vogais?", r: "2 vogais!" }
];

const card = document.getElementById("card-pile");
const diceBtn = document.getElementById("dice-btn");
const diceModal = document.getElementById("dice-modal");
const dice = document.getElementById("dice");
const diceTitle = document.getElementById("dice-title");
const verCartaBtn = document.getElementById("ver-carta-btn");
const rolarNovamenteBtn = document.getElementById("rolar-novamente-btn");

const modal = document.getElementById("challenge-modal");
const closeBtn = document.getElementById("close-btn");
const catEl = document.getElementById("desafio-cat");
const qEl = document.getElementById("desafio-q");
const rEl = document.getElementById("desafio-r");
const showAnswerBtn = document.getElementById("show-answer-btn");
const okBtn = document.getElementById("ok-btn");

function rolarDado() {
    diceModal.style.display = 'flex';
    card.style.display = 'none'; 
    diceBtn.style.display = 'none';
    verCartaBtn.style.display = 'none';
    rolarNovamenteBtn.style.display = 'none';
    dice.style.animation = 'spin 0.2s linear infinite';
    diceTitle.textContent = "üé≤ Rolando o Dado...";

    let count = 0;
    const faces = ['‚öÄ','‚öÅ','‚öÇ','‚öÉ','‚öÑ','‚öÖ'];
    let intervalo = setInterval(() => {
        dice.textContent = faces[Math.floor(Math.random() * 6)];
        count++;
        if (count > 15) {
            clearInterval(intervalo);
            dice.style.animation = 'none';
            const final = Math.floor(Math.random() * 6) + 1;
            dice.textContent = faces[final - 1];
            diceTitle.textContent = `Saiu: ${final}!`; 
            
            verCartaBtn.style.display = 'inline-block'; 
            rolarNovamenteBtn.style.display = 'inline-block';
        }
    }, 100);
}

// *** ALTERA√á√ÉO AQUI: Esta fun√ß√£o agora s√≥ exibe a carta. ***
function mostrarCartaParaClique() {
    diceModal.style.display = 'none'; // Fecha o modal do dado
    diceBtn.style.display = 'none'; // Esconde o bot√£o Rolar Dado
    card.style.display = 'flex'; // Exibe a carta para ser clicada
}

// *** NOVA FUN√á√ÉO: Abre o modal do desafio ap√≥s o clique na carta. ***
function abrirModalDesafio() {
    card.style.display = 'none'; // Esconde a carta ao abrir o modal
    
    // Configura o desafio (mesma l√≥gica de antes)
    const desafio = desafios[Math.floor(Math.random() * desafios.length)];
    catEl.textContent = "Categoria: " + desafio.cat;
    qEl.textContent = desafio.q;
    rEl.textContent = "Resposta: " + desafio.r;
    
    rEl.style.display = 'none';
    okBtn.style.display = 'none';
    showAnswerBtn.style.display = 'inline-block';
    modal.style.display = 'flex'; // Exibe o modal
}

function toggleResposta() {
    rEl.style.display = (rEl.style.display === 'none') ? 'block' : 'none';
    showAnswerBtn.style.display = 'none';
    okBtn.style.display = 'inline-block';
}

function fecharModal() {
    modal.style.display = 'none'; 
    card.style.display = 'none'; 
    diceBtn.style.display = 'inline-block'; // Volta ao bot√£o inicial de Rolar Dado
}

// --- LISTENERS ATUALIZADOS ---

diceBtn.addEventListener("click", rolarDado);

// O bot√£o dentro do modal do dado agora chama 'mostrarCartaParaClique'
verCartaBtn.addEventListener("click", mostrarCartaParaClique); 

// *** NOVO LISTENER: A carta agora abre o modal do desafio ***
card.addEventListener("click", abrirModalDesafio);

rolarNovamenteBtn.addEventListener("click", rolarDado);
showAnswerBtn.addEventListener("click", toggleResposta);
okBtn.addEventListener("click", fecharModal);
closeBtn.addEventListener("click", fecharModal);

window.addEventListener("click", e => {
    if (e.target === diceModal) diceModal.style.display = 'none';
    if (e.target === modal) fecharModal();
});
</script>
</body>
</html>
